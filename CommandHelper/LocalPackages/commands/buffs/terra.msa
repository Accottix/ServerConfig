

earth:/earth = >>>

@magnitude = 2; // speed of falling block
@damage = 50; // amount of damage the block will do to other players

// get the starting location
@loc = ploc();
@loc['y'] += 2; // chest height

// get the vector from player yaw/pitch
@yaw = @loc['yaw'] + 90;
@pitch = neg(@loc['pitch']);
@vector = associative_array();
@vector['x'] = @magnitude * (cos(to_radians(@yaw)) * cos(to_radians(@pitch)));
@vector['y'] = @magnitude * sin(to_radians(@pitch));
@vector['z'] = @magnitude * (sin(to_radians(@yaw)) * cos(to_radians(@pitch)));

@id = spawn_falling_block(@loc, 3, @vector);

#@var = 0
#export('var',@var)

bind(entity_change_block, associative_array('id': 'magneto'.@id), associative_array('to': 3), 
        @event, @id, @damage, @player = player()) {
            
            @loc = entity_loc(@id);
            drop_item(@loc,array(type: 3, qty: 1))
            cancel()
            
}

set_interval(50, closure(){
    try {
        #@var = import('var')
        #if(@var < 3){
        #    @var = @var +1
        #    export('var',@var)
        #    return()
        #}
        @loc = entity_loc(@id);
        @loc['y'] -= 1; // so we detect if the block is at player chest height
        foreach(@p in entities_in_radius(@loc, 3)) {
            // apply damage to player's UUID and attribute it to current player
            if(is_entity_living(@p)){
                damage_entity(puuid(@p), @damage, puuid());
            }
        }
    } catch(Exception @ex) {
        // entity no longer exists, clear the interval
        clear_task();
        // unbind the landing event
        unbind('magneto'.@id);
    }});

<<<


associative_array(
            'id': '124',
            'name': '§eT§8e§6r§8r§7a',
            'class': 'terra',
            'sig': 'Pg79Kjy3JYLPBbi8+wjqpm8XWw/hThhj7YfvDnCPGKhgKbbwYzUSRpVTEoEGRzkFMK9XPzurU/szfPOgBwScx56b3DxJ/pQSU6/LpQeQP2B9ZJ2rc3NGWxYbBy+/hcUGZCmROpoTVKPnQ/irtTQ7TY8GlvWU1a6WeRuSy6DjwI5Yx4YoccBPUpOJDnouW1GbRoFoWWNnHLBw7Z3pN/POLd4bP05rbSTByH/zPiXrJpedu4jMihVhAghQp+oNk2QylFcBOjZ+Nn0Klky054oE7RpB82GHjS58nPNwcUb2gqWmsluLq6p3XuGTl7IOSyYc+E/ojobPEgYLgZBaeOcjvlLi9G5PoRDW+phtVpLvi0ufTUl1KrFDXsfzEpWclAlHRQffMPeEJDUreWHzdGjSAvAC90VOFKQqhLlm5V253RDQkrYeA6r4Z4viQcoEEIgO7PoWMCVGSR+83t92plp+jhyuErEUaydsceerot4aAzrXB6PRkwFAXVVNQM8iGm9VwCFH/YI4AJtw6k1aFF1+olP0RyzriGHvoJUtWtMuWtzyF9UCAPjkN5L+LXBqyRPAoQaH91PYgopcukXn8WDIq0kj7woY76eRe3YLj6eHNa3jjzoY5MDgPELgL/JekIl1NExpNFmJ5Fd6NCKRyOCZR2PhQwOeTHFuH1Xabwdy8lc=',
            'val': 'eyJ0aW1lc3RhbXAiOjE0NzUyMDc5NDIyODUsInByb2ZpbGVJZCI6Ijg3ZmIzYzZjNWZmNjRiZjZiMzI2OTkyYzYxMzdlYTEyIiwicHJvZmlsZU5hbWUiOiJUZWt0cm9uaWMiLCJzaWduYXR1cmVSZXF1aXJlZCI6dHJ1ZSwidGV4dHVyZXMiOnsiU0tJTiI6eyJtZXRhZGF0YSI6eyJtb2RlbCI6InNsaW0ifSwidXJsIjoiaHR0cDovL3RleHR1cmVzLm1pbmVjcmFmdC5uZXQvdGV4dHVyZS8zNzIxZTM2ODExYTIwYzQ2OTMwYzJkYWUzYTE5YmM5NDdiNWExZDE1NmM4YjIzYzllZjFkZDFhYmNkN2UzNzUifX19',
            'trail': '',
            'op': 'false',
            'speech': "My name is Terra... And I have done horrible things.",
            'powers': array(
                "/".@class,
                "/jump 0-2",
                "/run 0-1",
                "/haste 0-2",
                "/earth (launches an dirt shot)"
            ),
            'buffs': array(
                "/effect player() 21 9999 4 true",
                "/effect player() 11 9999 1 true",
                "/effect player() 5 9999 3 true"                
            )
        )