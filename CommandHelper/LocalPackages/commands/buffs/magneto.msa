

ma:/ma = >>>

@magnitude = 2; // speed of falling block
@damage = 50; // amount of damage the block will do to other players

// get the starting location
@loc = ploc();
@loc['y'] += 2; // chest height

// get the vector from player yaw/pitch
@yaw = @loc['yaw'] + 90;
@pitch = neg(@loc['pitch']);
@vector = associative_array();
@vector['x'] = @magnitude * (cos(to_radians(@yaw)) * cos(to_radians(@pitch)));
@vector['y'] = @magnitude * sin(to_radians(@pitch));
@vector['z'] = @magnitude * (sin(to_radians(@yaw)) * cos(to_radians(@pitch)));

@id = spawn_falling_block(@loc, 42, @vector);

#@var = 0
#export('var',@var)

bind(entity_change_block, associative_array('id': 'magneto'.@id), associative_array('to': 42), 
        @event, @id, @damage, @player = player()) {
            
            @loc = entity_loc(@id);
            drop_item(@loc,array(type: 42, qty: 1))
            cancel()
            
}

set_interval(50, closure(){
    try {
        #@var = import('var')
        #if(@var < 3){
        #    @var = @var +1
        #    export('var',@var)
        #    return()
        #}
        @loc = entity_loc(@id);
        @loc['y'] -= 1; // so we detect if the block is at player chest height
        foreach(@p in entities_in_radius(@loc, 3)) {
            // apply damage to player's UUID and attribute it to current player
            if(is_entity_living(@p)){
                damage_entity(puuid(@p), @damage, puuid());
            }
        }
    } catch(Exception @ex) {
        // entity no longer exists, clear the interval
        clear_task();
        // unbind the landing event
        unbind('magneto'.@id);
    }});

<<<

associative_array(
            'id': '76',
            'name': '§4M§5a§4g§5n§4e§5t§4o',
            'class': 'magneto',
            'sig': 'uK6yrjF6fTCe/AWAI9Vnmh0U0ng2RewCb9OA9g+SQITHYkew4/wpO/Frvtb1sWnszBEAfHrXrl/vXtV3pTwOzzMN3YB7M34Qo2Z/KS9TassekOoAGGZTaJDK4JpOCdOOGnemJI1YI8X5Eh4ROPdR6DyvfnuK4MfMgJr/I8sCX1tReyv1JvuPVkeprsdGUSUmETdHLYL31fvOM/Zp97FkCiTB3AuKMawZWCE4s/dGBN+qqI6Iw8Qw+lhzT4OGssBUXET5gZ9eVV0HzPbko6P+R9kNYY9e1PRZVI4ZkkkCo13x5Sos8iic4Ei2D7rmDqg16dM9jYP/sHH/+n2kUavR6NieyRgb5dgYDSiQvgJR+F1iWsZ312ThnwVydgVFp+S/tBd4OjXJmGNFWtNAg2SU6XsRw5lQ9MZKwhihgp/MND9B4tRT/Iz2O83Qz5Iq92xRlBUHNdA4aJVA1Ndxo4RFn3w7bnTPzZgcG2xpxwS7Gg7MqvucDbqfRPd3hxckC5zsZGiR+Ju9zAi+gGe05Sn0uCxDHCbRnRyDqFnGAW18EXpSdRfJouN8NTm8LxB7V84EJrWjJU2UzdzDJgC7Vb4pXfIEZRpDtZiryI5zk56/C5i3U/En9sbsbASRbbCihhM2b7QS3uhlf/8s/w7TPYiazwlgZZ0PpENDZo82RBmrweo=',
            'val': 'eyJ0aW1lc3RhbXAiOjE0NjgzNzYxNDk4ODQsInByb2ZpbGVJZCI6IjAxMzAyOTlhNDQ4OTQyOWRiNGViNjg2NDNhNGM2YWM4IiwicHJvZmlsZU5hbWUiOiJHT1RlYW1MZW9HTyIsInNpZ25hdHVyZVJlcXVpcmVkIjp0cnVlLCJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvZTU2OTk5ZWFkYTliODgzYTkyOWZhZDdmMmU5NDcxZDQ1OGQ4OWM3ZmRjYjg0OTVjZmZhY2RlNjliMzYxZSJ9fX0=',
            'trail': '',
            'op': 'false',
            'speech': "Well let's just say I'm Frankenstein's monster...",
            'powers': array(
                "/".@class,
                "/ma (this is his iron attack!)",
                "/jump 0-1",
                "/run 0-1",
                "/haste 0-1",
                "/iron",
                "/fly"
            ),
            'buffs': array(
                "/effect player() 21 9999 4 true"                
            )
        )